// docstring: location checker. window binding is not required. you can block
// the window, BUT not in the place where the color is checked.
// 10.19.2023 https://github.com/kissmeandillkissumylove

start_script

gosub setdelay
gosub setwindowpos
wait 500 + random (500)

while 1 = 1 // main loop
    set #x 460
    set #y 430
    set #xx 40
    set #yy 40
    gosub humanclick // open menu
    wait 1000 + random (500)

    set #x 350
    set #y 200
    set #xx 50
    set #yy 50
    gosub humanclick // open society
    wait 1000 + random (500)

    set #x 350
    set #y 60
    set #xx 50
    set #yy 50
    gosub humanclick // open location
    wait 1000 + random (500)

    if_not 105, 94 5397099
        alarm
    end_if

    set #x 10
    set #y 450
    set #xx 100
    set #yy 10
    gosub humanclick // close
    wait 1000 + random (500)

end_while

end_script

:setdelay // set a delay between lines throughout the script
set linedelay 0
return

:setwindowpos // module which set the window position and get handle
set #warsphandle findwindow (Warspear)
set windowpos -7 0 526 521 #warsphandle
return

:humanclick // module which makes clicks similar to human ones
left_down #x #y 40 40 #warsphandle
wait 5 + random (40)
left_up #x #y #xx #yy
return